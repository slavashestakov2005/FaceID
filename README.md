Система «свой-чужой».  

## Техническое задание
1. Загрузили через страничку фото "свой", на выходе получили сетку обученную под распознание данного экземпляра фото
2. Перенесли обученную сетку на "свое железо" , без доступа в интернет, через web-камеру (желательно любую) система дает ответ свой\чужой в виде текста в локальный текстовый файл
3. При возможности подключения "своего железа" к интернету - текст отправляется в Телеграм-бот 
4. Скорость распознания на "стандартном" железе (видеокарта до 4gb, 2014-2017гг) до 1мс (будет круто)

## Структура проекта
### Recognition
Рапсознаёт изображение конкретного человеческого лица.  
#### Варианты библиотек
| № | Библиотека | Сокращенное название | Описание |
| ----- | ----- | ----- | ----- |
| 1. | face_recognition | fr | Переводит лица в вектора и сравнивает их. Скорость около одного кадра в секунду. |
| 2. | cv2 | cv | Тренирует LBPHFaceRecognizer. Работает быстро. |
| 3. | keras + tensorflow | net | Учится долго, определяет медленно и плохо. Большой расход вычислительной мощности. |

### Server
Представляет собой сервер, на который загружаются обучающие фото и выгружаются данные.
### Telegram
Telegram-бот, отправлющий сообщения «свой» или «чужой».

## Оценка качества работы
1. Для оценивания качетва работы модели были взяты близнецы (назовём их A и B) и я (C).
2. Из [этих видео](https://drive.google.com/drive/folders/1sgXQaNVnnItobKVXmAkRPKBQVhQ3R-xk?usp=sharing) были изалечены фотографии лиц.
3. Далле эти лица случайно поделены на тестовую (15%) и тренировочную (85%) части. Распределение [здесь](https://drive.google.com/drive/folders/1tC4sC-Vmhz2E7BP6ASIQ5FSO6Lp7j2ZQ?usp=sharing).
4. Для A, B и C были обучены отдельные модели (по тренировочным частям).
5. Каждая модель была проверена на своей тестовой части; разные люди проверялись на полном наборе фото.
6. Все результаты есть в папке `twins_tests` (в формате модель - фото).
7. Выводы:
    + Если модели показывают изображение «свой», то «коэффициент доверия» ниже 40, причём у близнецов показатель ниже.
    + Близнецы определяются с «коэффициентом доверия» около 75.
    + Не близнецы дают «коэффициент доверия» около 90.
8. Значит порог для «свой-чужой» должен быть примерно 60-70.

## Запуск
### Server
Файл `server.py` запускает сервер, получающий картинки и возвращающий распознаватель лиц.
### Client
Файл `client.py` запускает распознавание лиц по модели.

## Установка
+ Работает под `Python 3.8` (другие версии не проверялись), можно скачать [отсюда](https://www.python.org/downloads/).
+ Установить библиотеки согласно `requirements.txt`.
+ Если не удалось установить `dlib`, то можете воспользоваться тем, что находится в папке `lib` проекта.
Для этого скачайте себе эти файлы и из папки с ними запустите `pip38 install dlib-19.19.0-cp38-cp38-win_amd64.whl`
или `pip37 install dlib-19.19.0-cp37-cp37m-win_amd64.whl` (версия 3.7 не проверялась).

## Библиография
+ [Пример](https://habr.com/ru/company/netologyru/blog/434354/) с Face Recognition.
+ Ещё один [пример](https://pythonist.ru/raspoznavanie-licz-pri-pomoshhi-python-i-opencv/?ysclid=l2oyvdygyk).
+ [OpenCV и LBPHFaceRecognizer](https://robotos.in/uroki/obnaruzhenie-i-raspoznavanie-litsa-na-python).
+ Другой [пример](https://habr.com/ru/post/301096/).
+ [FaceNet](https://neurohive.io/ru/tutorial/raspoznavanie-lica-facenet/).

## Благодарности
Благодарю близнецов, принявших участие в тестировании системы. Имена не указываются без их согласия.
